<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phi·∫øu In</title>
    <!-- Include html2pdf.js library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        /* CSS Reset and Basic Setup */
        body {
            font-family: 'Times New Roman', Times, serif;
            font-size: 11px;
            line-height: 1.4;
            color: #000;
            background-color: #f4f4f4; /* N·ªÅn x√°m ƒë·ªÉ l√†m n·ªïi b·∫≠t trang gi·∫•y */
            margin: 0;
            padding: 0;
        }

        /* A4 Landscape Page Setup for Printing */
        @page {
            size: A4 landscape;
            margin: 5mm;
        }

        /* --- C·∫¢I TI·∫æN: T√ÅCH L·ªöP TR√åNH B√ÄY V√Ä N·ªòI DUNG --- */
        /* L·ªõp ngo√†i: T·∫°o h√¨nh ·∫£nh trang gi·∫•y A4 tr√™n m√†n h√¨nh */
        .page-container {
            width: 297mm; /* Chi·ªÅu r·ªông A4 landscape */
            min-height: 210mm; 
            padding: 5mm; /* Gi·∫£ l·∫≠p margin c·ªßa trang in, t·∫°o "vi·ªÅn tr·∫Øng" */
            margin: 10mm auto; /* CƒÉn gi·ªØa trang gi·∫•y tr√™n m√†n h√¨nh */
            background: #fff;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.15); /* Hi·ªáu ·ª©ng b√≥ng ƒë·ªï */
            box-sizing: border-box; 
        }
        /* L·ªõp trong: Ch·ª©a n·ªôi dung th·ª±c t·∫ø, s·∫Ω ƒë∆∞·ª£c xu·∫•t ra PDF */
        .invoice-content {
            width: 100%; /* Lu√¥n v·ª´a v·ªõi v√πng padding c·ªßa .page-container */
            height: 100%;
        }
        /* ----------------------------------------------------------- */

        /* --- STYLES FOR ON-SCREEN VIEW ONLY --- */
        .controls { text-align: center; padding: 15px; background-color: #333; }
        .controls button { background-color: #4CAF50; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; margin: 0 10px; }
        .controls button:hover { background-color: #45a049; }
        .controls button:disabled { background-color: #999; cursor: not-allowed;}
        
        /* Hide controls and reset styles when printing */
        @media print {
            body { background-color: #fff; }
            .controls { display: none; }
            .page-container {
                width: auto;
                min-height: auto;
                margin: 0;
                padding: 0;
                box-shadow: none;
            }
        }

        /* Header Styles (3-column layout) */
        .header-table { width: 100%; border-collapse: collapse; margin-bottom: 10px; }
        .header-table td { padding: 1px 4px; vertical-align: top; }
        .logo { max-height: 50px; }
        .company-details { width: 45%; }
        .company-details h3 { margin: 0; font-size: 13px; text-transform: uppercase; font-weight: bold; }
        .company-details p { margin: 0; font-size: 11px; }
        .title-cell { width: 30%; text-align: center; vertical-align: middle; }
        .title-cell h1 { margin: 0 0 5px 0; font-size: 22px; font-weight: bold; text-transform: uppercase; }
        .title-cell p { margin: 2px 0; font-size: 12px; }
        .qr-header-cell { width: 25%; text-align: right; }
        .qr-header-cell img { width: 50px; height: 50px; }

        /* Customer Info Table Styles (4-column layout) */
        .info-table { width: 100%; border-collapse: collapse; margin-bottom: 10px; table-layout: fixed;}
        .info-table td { border: 1px solid #000; padding: 3px 5px; vertical-align: top; width: 25%; }
        .info-table td strong { font-weight: bold; }

        /* Items Table Styles */
        .items-table { width: 100%; border-collapse: collapse; }
        .items-table th, .items-table td { border: 1px solid #000; padding: 4px; text-align: center; vertical-align: middle; }
        .items-table thead { display: table-header-group; }
        .items-table tfoot { display: table-footer-group; }
        .items-table th { background-color: #E6F5FF; font-weight: bold; text-align: center !important; }
        .items-table .text-left { text-align: left; }
        .items-table .text-right { text-align: right; }
        .items-table tfoot .total-row { font-weight: bold; background-color: #FFF2CC; }

        /* Summary Section Styles (3-column layout) */
        .summary-section { page-break-inside: avoid; }
        .summary-table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        .summary-table > tbody > tr > td { width: 33.33%; border: 1px solid #000; vertical-align: top; padding: 5px; min-height: 100px; }
        .notes-cell { text-align: left; font-size: 11px; }
        .qr-container table { width: 100%; border-collapse: collapse; }
        .qr-container td { border: none; padding: 0; vertical-align: middle; }
        .qr-image-cell { width: 100px; padding-right: 10px;}
        .qr-image-cell img { width: 90px; height: 90px; display: block; }
        .qr-info-cell .payment-info p { margin: 1px 0; font-size: 10px; text-align: left; }

        .summary-details-table { width: 100%; border-collapse: collapse; }
        .summary-details-table td { border: none; padding: 2px 5px; }
        .summary-details-table tr:not(:first-child) td { border-top: 1px solid #ccc; }
        .summary-details-table .label { text-align: right; font-weight: normal; }
        .summary-details-table .value { text-align: right; font-weight: bold; }

        /* Footer & Signatures */
        .footer { margin-top: 15px; padding-top: 10px; display: flex; justify-content: space-around; text-align: center; width: 100%; page-break-inside: avoid; }
        .signature { width: 20%; }
        .signature .signature-title { margin: 0; font-weight: bold; }
        .signature .signature-instruction { font-style: italic; font-size: 10px; font-weight: normal; margin: 0; }
        .signature .signature-name { margin-top: 45px; font-weight: bold; min-height: 1.2em; }
        
        /* Dynamic value styling */
        .dynamic-value { color: #0000FF; font-weight: normal; }
        .dynamic-value.bold { font-weight: bold; }
    </style>
</head>
<body>
    <div class="controls">
        <button onclick="window.print()">üñ®Ô∏è In ngay</button>
        <button id="download-btn" onclick="downloadPDF()">üìÑ T·∫£i PDF</button>
    </div>
    
    <div class="page-container">
        <div class="invoice-content" id="invoice-content">
            <!-- HEADER (3-column layout) -->
            <table class="header-table">
                <tr>
                    <td class="company-details">
                        <img src="logo-manlead.jpg" alt="Logo" class="logo">
                        <h3>C√îNG TY TNHH ƒê·∫¶U T∆Ø V√Ä TH∆Ø∆†NG M·∫†I T&B VI·ªÜT NAM</h3>
                        <p>ƒê·ªãa ch·ªâ: 55 ƒê∆∞·ªùng H√πng V∆∞∆°ng II, Ph·ªë L√™ L·ª£i, P Nam B√¨nh, Ninh B√¨nh</p>
                    </td>
                    <td class="title-cell">
                        <h1 id="tieuDePhieu"></h1>
                        <p>S·ªë phi·∫øu: <span id="soPhieu" class="dynamic-value" style="font-weight: bold;"></span></p>
                    </td>
                    <td class="qr-header-cell">
                        <img id="qrSoPhieu" src="" alt="QR Code" crossorigin="anonymous">
                    </td>
                </tr>
            </table>
            
            <!-- CUSTOMER INFO (4-column layout) -->
            <table class="info-table">
                <tr>
                    <td><strong>Nh√† ph√¢n ph·ªëi:</strong> <span id="nhaPhanPhoi" class="dynamic-value"></span></td>
                    <td><strong>Kh√°ch h√†ng:</strong> <span id="khachHang" class="dynamic-value bold"></span></td>
                    <td><strong>Doanh s·ªë NVKD:</strong> <span id="doanhSoNVKD" class="dynamic-value bold"></span></td>
                    <td><strong>Doanh s·ªë NPP:</strong> <span id="doanhSoNPP" class="dynamic-value bold"></span></td>
                </tr>
                <tr>
                    <td><strong>Nh√¢n vi√™n:</strong> <span id="nhanVien" class="dynamic-value"></span></td>
                    <td><strong>ƒê·ªãa ch·ªâ:</strong> <span id="diaChi" class="dynamic-value"></span></td>
                    <td><strong>Ti·ªÅn tr·∫£ NPP:</strong> <span id="tienTraNPP" class="dynamic-value"></span></td>
                    <td><strong>Ti·ªÅn ph·∫£i thu:</strong> <span id="tienPhaiThu" class="dynamic-value bold"></span></td>
                </tr>
                <tr>
                    <td><strong>Ng√†y:</strong> <span id="ngay" class="dynamic-value"></span></td>
                    <td><strong>T·ªânh:</strong> <span id="tinh" class="dynamic-value"></span> | <strong>Khu v·ª±c:</strong> <span id="khuVuc" class="dynamic-value"></span></td>
                    <td colspan="2">
                       <strong>ƒê·ªëi t∆∞·ª£ng:</strong> <span id="doiTuong" class="dynamic-value"></span>
                       | <strong>%CKKH:</strong> <span id="ckkh" class="dynamic-value bold"></span>
                       | <strong>%CKNPP:</strong> <span id="cknpp" class="dynamic-value"></span>
                       | <strong>%CK kh√°c:</strong> <span id="ckKhac" class="dynamic-value"></span>
                    </td>
                </tr>
            </table>

            <!-- ITEMS TABLE -->
            <table class="items-table">
                 <thead>
                    <tr>
                        <th rowspan="2" style="width: 3%;">Stt</th>
                        <th rowspan="2" style="width: 9%;">M√£ H√†ng</th>
                        <th rowspan="2" style="width: 9%;">T√™n H√†ng</th>
                        <th rowspan="2" style="width: 4%;">ƒêvt</th>
                        <th rowspan="2" style="width: 4%;">SL</th>
                        <th rowspan="2" style="width: 7%;" class="text-right">ƒê∆°n gi√°</th>
                        <th rowspan="2" style="width: 7%;">M√†u</th>
                        <th colspan="7">SIZE</th>
                        <th rowspan="2" style="width: 8%;" class="text-right">Th√†nh ti·ªÅn bao b√¨</th>
                        <th rowspan="2" style="width: 8%;" class="text-right">Th√†nh ti·ªÅn chi·∫øt kh·∫•u</th>
                        <th rowspan="2" style="width: 8%;">Ghi ch√∫</th>
                    </tr>
                    <tr>
                        <th style="width: 3.5%;">S (29)</th><th style="width: 3.5%;">M (30)</th><th style="width: 3.5%;">L (31)</th>
                        <th style="width: 3.5%;">XL(32)</th><th style="width: 3.5%;">XXL(33)</th><th style="width: 3.5%;">3XL(34)</th>
                        <th style="width: 3.5%;">4XL(35)</th>
                    </tr>
                </thead>
                <tbody id="chiTietDonHang"></tbody>
                <tfoot>
                    <tr class="total-row">
                        <td colspan="4" class="text-right"><strong>Total</strong></td>
                        <td><span id="tongCongSoLuong" class="dynamic-value"></span></td>
                        <td colspan="9"></td> <!-- Spacer for Don Gia, Mau, and 7 Sizes -->
                        <td class="text-right"><span id="tongThanhTienBaoBi" class="dynamic-value"></span></td>
                        <td class="text-right"><span id="tongThanhTienChietKhau" class="dynamic-value"></span></td>
                        <td></td>
                    </tr>
                </tfoot>
            </table>

            <!-- SUMMARY SECTION (3 COLUMNS) -->
            <div class="summary-section">
                <table class="summary-table">
                    <tr>
                        <td class="notes-cell"><div id="ghiChuFooter"></div></td>
                        <td class="payment-qr-cell">
                             <div class="qr-container">
                                <table>
                                    <tr>
                                        <td class="qr-image-cell"><img id="qrThanhToan" src="" alt="VietQR Payment" crossorigin="anonymous"></td>
                                        <td class="qr-info-cell">
                                            <div class="payment-info">
                                                <p><strong>Qu√©t m√£ ƒë·ªÉ thanh to√°n</strong></p>
                                                <p>Ng√¢n h√†ng: <span id="nganHang" class="dynamic-value"></span></p>
                                                <p>Ch·ªß TK: <span id="chuTaiKhoan" class="dynamic-value"></span></p>
                                                <p>N·ªôi dung: <span id="ndChuyenKhoan" class="dynamic-value"></span></p>
                                            </div>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </td>
                        <td class="summary-details-cell">
                            <table class="summary-details-table">
                                <tr><td class="label">C·ªông ti·ªÅn h√†ng:</td><td class="value"><span id="congTienHang" class="dynamic-value"></span></td></tr>
                                <tr><td class="label">Ti·ªÅn chi·∫øt kh·∫•u:</td><td class="value">(<span id="tienChietKhau" class="dynamic-value"></span>)</td></tr>
                                <tr><td class="label">T·ªïng c·ªông (tr∆∞·ªõc VAT):</td><td class="value"><span id="tongTruocVAT" class="dynamic-value"></span></td></tr>
                                <tr><td class="label" id="vatLabelCell">Thu·∫ø su·∫•t VAT (0%):</td><td class="value"><span id="tienVAT" class="dynamic-value"></span></td></tr>
                                <tr><td class="label" style="font-size: 12px;"><strong>T·ªîNG TI·ªÄN THANH TO√ÅN:</strong></td><td class="value" style="font-size: 12px;"><strong id="tongThanhToan" class="dynamic-value"></strong></td></tr>
                                <tr><td colspan="2" style="text-align: right; font-style: italic; padding-top: 8px;"><strong>Vi·∫øt b·∫±ng ch·ªØ:</strong> <span id="tongTienBangChu" class="dynamic-value"></span></td></tr>
                            </table>
                        </td>
                    </tr>
                </table>
            </div>

            <!-- SIGNATURES -->
            <div class="footer">
                <div class="signature"><p class="signature-title">Ng∆∞·ªùi l·∫≠p phi·∫øu</p><p class="signature-instruction">(K√Ω, h·ªç t√™n)</p><p class="signature-name"><span id="tenNguoiLapFooter" class="dynamic-value"></span></p></div>
                <div class="signature"><p class="signature-title">Ng∆∞·ªùi duy·ªát</p><p class="signature-instruction">(K√Ω, h·ªç t√™n)</p><p class="signature-name"><span id="tenNguoiDuyetFooter" class="dynamic-value"></span></p></div>
                <div class="signature"><p class="signature-title">Th·ªß kho</p><p class="signature-instruction">(K√Ω, h·ªç t√™n)</p><p class="signature-name">&nbsp;</p></div>
                <div class="signature"><p class="signature-title">Kh√°ch h√†ng</p><p class="signature-instruction">(K√Ω, h·ªç t√™n)</p><p class="signature-name">&nbsp;</p></div>
            </div>
        </div>
    </div>

    <script>
        const demoData = {
             chiTietDonHang: [
                {ma: 'GAS006-ƒê', ten: 'Slim fit', dvt: 'Chi·∫øc', sl: 2, donGia: '625.000 ƒë', mau: 'ƒêen', s: 2, m: '', l: '', xl: '', xxl: '', '3xl': '', '4xl': '', thanhTienBaoBi: '1.250.000 ƒë', thanhTienChietKhau: '750.000 ƒë', ghiChu: ''},
                {ma: 'GAR002-ƒê', ten: 'Regular', dvt: 'Chi·∫øc', sl: 7, donGia: '650.000 ƒë', mau: 'ƒêen', s: 1, m: 2, l: 2, xl: 2, xxl: '', '3xl': '', '4xl': '', thanhTienBaoBi: '4.550.000 ƒë', thanhTienChietKhau: '2.730.000 ƒë', ghiChu: ''},
                {ma: 'GAS7-ƒê', ten: 'Slim fit', dvt: 'Chi·∫øc', sl: 2, donGia: '545.000 ƒë', mau: 'ƒêen', s: 2, m: '', l: '', xl: '', xxl: '', '3xl': '', '4xl': '', thanhTienBaoBi: '1.090.000 ƒë', thanhTienChietKhau: '654.000 ƒë', ghiChu: ''},
                {ma: 'GAS006-GX', ten: 'Slim fit', dvt: 'Chi·∫øc', sl: 2, donGia: '625.000 ƒë', mau: 'Ghi X√°m', s: '', m: '', l: '', xl: 2, xxl: '', '3xl': '', '4xl': '', thanhTienBaoBi: '1.250.000 ƒë', thanhTienChietKhau: '750.000 ƒë', ghiChu: ''},
            ]
        };
        
        function numberToVietnameseWords(n) {
            const defaultNumbers = ['kh√¥ng', 'm·ªôt', 'hai', 'ba', 'b·ªën', 'nƒÉm', 's√°u', 'b·∫£y', 't√°m', 'ch√≠n'];
            const units = ['', 'ngh√¨n', 'tri·ªáu', 't·ª∑', 'ngh√¨n t·ª∑', 'tri·ªáu t·ª∑'];
            function readThreeDigits(n, isFull) {
                let hundred = Math.floor(n / 100); let ten = Math.floor((n % 100) / 10); let one = n % 10; let result = [];
                if (hundred > 0 || isFull) { result.push(defaultNumbers[hundred], 'trƒÉm'); }
                if (ten === 0 && one > 0 && hundred > 0) { result.push('linh');
                } else if (ten === 1) { result.push('m∆∞·ªùi');
                } else if (ten > 1) { result.push(defaultNumbers[ten], 'm∆∞∆°i'); }
                if (one > 0) {
                    if (ten === 0 && hundred === 0) { result.push(defaultNumbers[one]);
                    } else if (ten >= 1 && one === 1) { result.push('m·ªët');
                    } else if (ten >= 2 && one === 5) { result.push('lƒÉm');
                    } else if (ten >= 1 && one === 5) { result.push(defaultNumbers[one]);
                    } else if (one === 4 && ten > 1) { result.push('t∆∞');
                    } else { result.push(defaultNumbers[one]); }
                }
                return result.join(' ');
            }
            if (n === 0) return 'Kh√¥ng ƒë·ªìng.'; if (n < 0) return 'S·ªë √¢m ' + numberToVietnameseWords(-n);
            let str = String(n); let parts = [];
            while (str.length > 0) { parts.unshift(str.slice(Math.max(0, str.length - 3))); str = str.slice(0, Math.max(0, str.length - 3)); }
            let resultWords = [];
            for (let i = 0; i < parts.length; i++) {
                let num = parseInt(parts[i]);
                if (num > 0) {
                    let chunkWords = readThreeDigits(num, i > 0 && parts[i].length < 3);
                    resultWords.push(chunkWords, units[parts.length - 1 - i]);
                }
            }
            let finalStr = resultWords.join(' ').trim();
            if(finalStr === '') return 'Kh√¥ng ƒë·ªìng.';
            finalStr = finalStr.charAt(0).toUpperCase() + finalStr.slice(1);
            return finalStr + ' ƒë·ªìng.';
        }
        
        function populateTable(data) {
            const tableBody = document.getElementById('chiTietDonHang');
            tableBody.innerHTML = '';
            data.forEach((item, index) => {
                const row = `<tr><td>${index + 1}</td><td class="text-left">${item.ma || ''}</td><td class="text-left">${item.ten || ''}</td><td>${item.dvt || ''}</td><td>${item.sl || ''}</td><td class="text-right">${item.donGia || ''}</td><td class="text-left">${item.mau || ''}</td><td>${item.s || ''}</td><td>${item.m || ''}</td><td>${item.l || ''}</td><td>${item.xl || ''}</td><td>${item.xxl || ''}</td><td>${item['3xl'] || ''}</td><td>${item['4xl'] || ''}</td><td class="text-right">${item.thanhTienBaoBi || ''}</td><td class="text-right">${item.thanhTienChietKhau || ''}</td><td>${item.ghiChu || ''}</td></tr>`;
                tableBody.innerHTML += row;
            });
        }
        
        function downloadPDF() {
            const downloadBtn = document.getElementById('download-btn');
            downloadBtn.textContent = 'ƒêang x·ª≠ l√Ω...';
            downloadBtn.disabled = true;

            const element = document.getElementById('invoice-content'); // Target the inner content div
            const soPhieu = document.getElementById('soPhieu').textContent || 'PhieuXuatKho';

            const opt = {
                margin:       5, // Let jsPDF handle the margin
                filename:     `${soPhieu}.pdf`,
                image:        { type: 'jpeg', quality: 0.98 },
                html2canvas:  { scale: 2, useCORS: true, width: element.scrollWidth, height: element.scrollHeight },
                jsPDF:        { unit: 'mm', format: 'a4', orientation: 'landscape' },
                pagebreak:    { mode: ['avoid-all', 'css', 'legacy'] }
            };

            html2pdf().from(element).set(opt).save().then(() => {
                downloadBtn.textContent = 'üìÑ T·∫£i PDF';
                downloadBtn.disabled = false;
            }).catch((err) => {
                console.error("PDF generation failed:", err);
                downloadBtn.textContent = 'üìÑ T·∫£i PDF';
                downloadBtn.disabled = false;
            });
        }

        document.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            const soPhieuParam = urlParams.get('soPhieu');
            if (soPhieuParam) {
                // LIVE MODE - Data from AppSheet
                document.title = urlParams.get('tieuDePhieu') || `Phi·∫øu - ${soPhieuParam}`;
                const fields = [
                    'tieuDePhieu', 'soPhieu', 'ngay', 'nhaPhanPhoi', 'nhanVien', 'khachHang', 'diaChi', 'tinh', 'khuVuc', 'doiTuong',
                    'doanhSoNVKD', 'doanhSoNPP', 'tienTraNPP', 'tienPhaiThu', 'ckkh', 'cknpp', 'ckKhac',
                    'tongCongSoLuong', 'tongSizeS', 'tongSizeM', 'tongSizeL', 'tongSizeXL', 'tongSizeXXL', 'tongSize3XL', 'tongSize4XL',
                    'tongThanhTienBaoBi', 'tongThanhTienChietKhau',
                    'congTienHang', 'tienChietKhau', 'tongTruocVAT', 'tienVAT', 'tongThanhToan', 
                    'nganHang', 'chuTaiKhoan', 'ndChuyenKhoan',
                    'tenNguoiLapFooter', 'tenNguoiDuyetFooter'
                ];
                fields.forEach(id => {
                    const element = document.getElementById(id);
                    if (element && urlParams.has(id)) { element.textContent = urlParams.get(id); }
                });
                
                document.getElementById('qrSoPhieu').src = `https://api.qrserver.com/v1/create-qr-code/?size=50x50&data=${encodeURIComponent(soPhieuParam)}`;
                
                const qrAmount = urlParams.get('tongThanhToanNumeric') || '0';
                const qrAccountNo = urlParams.get('stk') || '19132563929019';
                const qrAcqId = urlParams.get('acqId') || '970407';
                const qrAccountName = urlParams.get('chuTaiKhoan') || 'CONG TY TNHH T&B VIET NAM';
                document.getElementById('qrThanhToan').src = `https://img.vietqr.io/image/${qrAcqId}-${qrAccountNo}-compact2.png?amount=${qrAmount}&addInfo=${encodeURIComponent(soPhieuParam)}&accountName=${encodeURIComponent(qrAccountName)}`;
                
                const vatRateParam = urlParams.get('vatRate');
                if (vatRateParam) { document.getElementById('vatLabelCell').textContent = `Thu·∫ø su·∫•t VAT (${vatRateParam}%):`; }
                
                const ghiChuText = urlParams.get('ghiChuCuoiPhieu');
                if (ghiChuText && ghiChuText.trim() !== "") { 
                    document.getElementById('ghiChuFooter').innerHTML = `<p style="margin:0; padding:0;"><strong>Ghi ch√∫:</strong></p><p style="margin:0; padding:0; font-style: italic;">${ghiChuText}</p>`;
                }
                
                const tongTienNumeric = parseInt(qrAmount, 10);
                if (!isNaN(tongTienNumeric)) { document.getElementById('tongTienBangChu').textContent = numberToVietnameseWords(tongTienNumeric); }
                
                try {
                    const chiTietData = JSON.parse(decodeURIComponent(urlParams.get('chiTietHangHoa')));
                    populateTable(chiTietData);
                } catch (e) { console.error("Error parsing chiTietHangHoa:", e); }
            } else {
                // DEMO MODE - For direct viewing and testing
                document.title = 'PHI·∫æU XU·∫§T KHO (DEMO)';
                populateTable(demoData.chiTietDonHang);
                
                document.getElementById('tieuDePhieu').textContent = 'PHI·∫æU XU·∫§T KHO';
                document.getElementById('soPhieu').textContent = 'PX250904112753';
                document.getElementById('qrSoPhieu').src = 'https://api.qrserver.com/v1/create-qr-code/?size=50x50&data=PX250904112753';
                document.getElementById('nhaPhanPhoi').textContent = 'C√¥ng Ty TB';
                document.getElementById('nhanVien').textContent = 'V≈© Th·ªã Minh KD';
                document.getElementById('ngay').textContent = '04/09/2025';
                document.getElementById('khachHang').textContent = 'Shop Quang Huy';
                document.getElementById('diaChi').textContent = '257,Tr·∫ßn Nh√¢n T√¥ng,P y√™n Thanh, TP U√¥ng B√≠, T·ªânh Qu·∫£ng Ninh';
                document.getElementById('tinh').textContent = 'Qu·∫£ng Ninh';
                document.getElementById('khuVuc').textContent = 'ƒêB';
                document.getElementById('doanhSoNVKD').textContent = '4.395.600 ƒë';
                document.getElementById('doanhSoNPP').textContent = '4.395.600 ƒë';
                document.getElementById('tienTraNPP').textContent = '0 ƒë';
                document.getElementById('tienPhaiThu').textContent = '4.884.000 ƒë';
                document.getElementById('doiTuong').textContent = 'kh√°ch l·∫ª';
                document.getElementById('ckkh').textContent = '40%';
                document.getElementById('cknpp').textContent = '0%';
                document.getElementById('ckKhac').textContent = '10%';
                
                document.getElementById('tongCongSoLuong').textContent = '13';
                document.getElementById('tongSizeS').textContent = '5';
                document.getElementById('tongSizeM').textContent = '2';
                document.getElementById('tongSizeL').textContent = '2';
                document.getElementById('tongSizeXL').textContent = '4';
                document.getElementById('tongSizeXXL').textContent = '0';
                document.getElementById('tongSize3XL').textContent = '0';
                document.getElementById('tongSize4XL').textContent = '0';
                document.getElementById('tongThanhTienBaoBi').textContent = '8.140.000 ƒë';
                document.getElementById('tongThanhTienChietKhau').textContent = '4.884.000 ƒë';
                
                document.getElementById('ghiChuFooter').innerHTML = `<p style="margin:0; padding:0;"><strong>Ghi ch√∫:</strong></p><p style="margin:0; padding:0; font-style: italic;">Vui l√≤ng ki·ªÉm tra h√†ng k·ªπ tr∆∞·ªõc khi nh·∫≠n.</p>`;
                document.getElementById('nganHang').textContent = 'Techcombank';
                document.getElementById('chuTaiKhoan').textContent = 'CONG TY TNHH T&B VIET NAM';
                document.getElementById('ndChuyenKhoan').textContent = 'PX250904112753';
                document.getElementById('qrThanhToan').src = 'https://img.vietqr.io/image/970407-19132563929019-compact2.png?amount=4884000&addInfo=PX250904112753&accountName=CONG%20TY%20TNHH%20T%26B%20VIET%20NAM';

                document.getElementById('congTienHang').textContent = '8.140.000 ƒë';
                document.getElementById('tienChietKhau').textContent = '3.256.000 ƒë';
                document.getElementById('tongTruocVAT').textContent = '4.884.000 ƒë';
                document.getElementById('vatLabelCell').textContent = 'Thu·∫ø su·∫•t VAT (0%):';
                document.getElementById('tienVAT').textContent = '0 ƒë';
                document.getElementById('tongThanhToan').textContent = '4.884.000 ƒë';
                document.getElementById('tongTienBangChu').textContent = numberToVietnameseWords(4884000);

                document.getElementById('tenNguoiLapFooter').textContent = 'Ho√†ng Th·ªã Kim Th√†nh';
                document.getElementById('tenNguoiDuyetFooter').textContent = '';
            }
        });
    </script>
</body>
</html>
